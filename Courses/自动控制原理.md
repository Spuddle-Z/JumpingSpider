---
tags:
  - Knowledge
---
## 控制系统的复域模型
### 线性定常系统
我们将系统的输入输出分别记为$r(t),c(t)$（就是“入”和“出”的首字母），那么对于线性定常系统，我们可以根据输入输出的关系列出一个微分方程，其一般形式为
$$\sum_{i=0}^{n}a_n\frac{d^n}{dt^n}c(t)=\sum_{i=0}^{m}b_{m}\frac{d^m}{dt^m}r(t)$$
将等式两端同时进行[[高等数学#拉普拉斯变换|拉普拉斯变换]]之后得到
$$C(s)\cdot\sum_{i=0}^{n}a_ns^n=R(s)\cdot\sum_{i=0}^{m}b_ms^{m}$$

> [!note] 时域、复域、频域关系总览
> 一个线性定常系统在时域、复域、频域都有相应的描述，三种描述之间可以相互转换，如下图：
> ![[Pasted image 20240918231554.png|325]]

### 传递函数
对于一个自动控制系统，我们一般选择一个零初始条件，即在$t<0$的时候，系统的所有状态均为零。

> [!definition] 传递函数
> 在零初始条件下，线性定常系统输出量的拉普拉斯变换与输入量的拉普拉斯变换之比，即
> $$G(s)=\frac{C(s)}{R(s)}$$

$G(s)$可以被格式化为**首1标准型**和**尾1标准型**。首1标准型即令分子分母的最高次项系数为1，尾1标准型即令分子分母的最低次项系数为1。

> [!example] 开环传递函数
> ![[Pasted image 20240917161937.png|450]]
> 欲求上图中的开环传递函数，我们先将其主反馈（即从输出直接传递给输入的反馈）去掉，得到
> ![[Pasted image 20240917162115.png|450]]
> 算出此时系统的传递函数$G'(x)$，再乘上主反馈的增益$H_1(s)$，就得到整个系统的开环传递函数为$G'(s)H_1(s)$。
> > [!caution] 
> > 注意负反馈的负号并没有乘到结果里。

### Mason增益公式
> [!definition] Mason增益公式
> 用于求一个系统的传递函数，其公式如下：
> $$G(s)=\frac{1}{\Delta}\sum_{i=1}^{n}P_i\Delta_i$$
> 其中：
> - $\Delta$为流图特征式
> 	$$\Delta=1-\sum L_a+\sum L_{b}L_{c}-\sum L_{d}L_{e}L_{f}+\cdots$$
> 	- $\sum L_{a}$是所有回路增益之和；
> 	- $\sum L_{b}L_{c}$是所有互不接触的回路对的增益乘积之和；
> 	- $\sum L_{d}L_{e}L_{f}$是所有互不接触的回路三元组的增益乘积之和；
> 	- 后面以此类推……
> - $n$是从输入到输出的前向通路条数；
> - $P_i$是第$i$条前向通路上的增益；
> - $\Delta_i$是不与第$i$条前向通路接触的回路的增益。

> [!example] 
> ![[图片1.jpg|425]]
> 对于上面这道题，我们可以找到3个回路与2条通路：
> ![[Pasted image 20240916212017.png|425]]
> $$
> \left\{\begin{aligned}
> L_1&=-G_1H_1\\
> L_2&=-G_3H_2\\
> L_3&=-G_1G_2G_3H_1H_2\\
> P_1&=G_1G_2G_3\\
> P_2&=G_3G_4
> \end{aligned}\right.
> $$
> 其中回路I、II不接触，因此有
> $$\Delta=1-(L_1+L_2+L_3)+L_1L_2$$
> 通路$P_1$和所有的回路都接触，因此其余子式$\Delta_1=1$；而通路$P_2$与回路I不接触，因此$\Delta_2=1-(-G_1H_1)$。
> 
> 把上面的所有结果都代入Mason公式，得
> $$
> \begin{aligned}
> G(s)&=\frac{P_1\Delta_1+P_2\Delta_2}{\Delta}\\
> &=\frac{G_1G_2G_3+G_3G_4+G_1G_3G_4H_1}{1+G_1H_1+G_3H_2+G_1G_2G_3H_1H_2+G_1G_3H_1H_2}
> \end{aligned}
> $$

## 线性系统的时域分析与校正
### 一阶系统
一阶系统的传递函数可化为尾1标准型
$$\Phi(s)=\frac{K}{Ts+1}$$
其中$T$是这个系统的一个重要常数，$3T$为这个系统的**调节时间**；$K$为系统的**放大倍数**。

### 二阶系统
![[Pasted image 20240917214405.png|300]]
二阶系统的典型结构如上图，其中$\omega_n$为无阻尼自然频率，$\xi$为阻尼比，且
$$
\left\{\begin{aligned}
G(s)&=\frac{\omega_n^2}{s(s+2\xi\omega_n)}\\
\Phi(s)&=\frac{\omega_n^2}{s^2+2\xi\omega_ns+\omega_n^2}
\end{aligned}\right.
$$

我们主要研究欠阻尼的情况，也即$0\leq\xi<1$的情况，其图像如下图：
![[Pasted image 20240917222833.png|475]]

此时二阶系统的三个动态性能如下：
- **超调量**$\sigma$%为第一个峰值的超出稳定值的百分数；
- **峰值时间**$t_{p}$为到达第一个峰值的时间；
- **调整时间**$t_{s}$为稳定到一个固定范围$\Delta$内的时间。

三者的公式如下：
$$
\left\{\begin{aligned}
\sigma\%&=e^{-\frac{\xi\pi}{\sqrt{1-\xi^2}}}\times100\%\\
t_{p}&=\frac{\pi}{\sqrt{1-\xi^2}\omega_n}\\
t_{s}&=\frac{3.5}{\xi\omega_n}
\end{aligned}\right.
$$

> [!note] 记忆方法
> $\xi\omega_n$是极点实部，$\sqrt{1-\xi^2}\omega_n$是极点虚部。$t_{s}$是$3.5$除以实部，$t_{p}$是$\pi$除以虚部，$\sigma\%$系数是实部除以虚部。

### 稳定性分析
> [!definition] 稳定性
> 系统受到微小扰动就会偏离其稳定位置即为不稳定。

传递函数是一个复函数，它的极点（即分母为零的位置）决定了系统的稳定性。**特征方程**的根即为系统的极点，线性系统的特征方程形式一般如下：
$$D(s)=\sum_{i=0}^{n}a_is^{i}=0$$

对于特征方程为$D(s)=\sum_{i=0}^{n}a_is^{i}=0$的线性系统，其稳定性有如下判据：
1. 必要条件是$a_i>0$，即如果存在异号的$a_i,a_j$，或$a_i=0$，则系统一定不稳定；
2. 当系统满足必要条件时，使用劳斯判据，其判断方法如下
	> [!example] 劳斯判据
	> 对于特征方程$D(s)=s^4+5s^3+7s^2+2s+10=0$，我们需要列出劳斯表。先列出其前两行
	> $$
	> \begin{matrix}
	> s^4&1&7&10\\
	> s^3&5&2&
	> \end{matrix}
	> $$
	> 后面的行则计算较为复杂，$s^2$行的两个数计算方法如下：
	> ![[Pasted image 20240918132007.png|350]]
	> $$
	> \begin{aligned}
	> \frac{5\times7-1\times2}{5}=\frac{33}{5}\\
	> \frac{5\times10-1\times0}{5}=10
	> \end{aligned}
	> $$
	> 以此规律计算后面直到$s^0$行的数，得到
	> $$
	> \begin{matrix}
	> s^4&1&7&10\\
	> s^3&5&2&\\
	> s^2&\frac{33}{5}&10\\
	> s^1&-\frac{184}{33}\\
	> s^0&10
	> \end{matrix}
	> $$
	> 如果计算正确，$s^0$行应该只剩一个数，且就是常数项的数。
	> 
	> 此时如果劳斯表的第一列全部为正数，则系统稳定；否则系统不稳定，且符号改变的次数即为特征方程正实部根的个数。此例子中，符号改变了两次，特征方程有两个正实部根。
1. 如果遇到某一行全部是零，就用上一行求导后的系数代替此行；如果只有某行第一个数是零，将其用一个无穷小量$\varepsilon$代替，继续计算。
	> [!example] 劳斯判据的特殊情况
	> 对于$D(s)=s^5+2s^4-s-2=0$，其劳斯表为
	> $$
	> \begin{matrix}
	> s^5&1&0&-1\\
	> s^4&2&0&-2\\
	> s^3&0&0
	> \end{matrix}
	> $$
	> 我们发现$s^3$行全部为零，则列出上一行的辅助方程$2s^4-2=0$，求导后得到$8s^3=0$，将其系数填入劳斯表后继续计算
	> $$
	> \begin{matrix}
	> s^5&1&0&-1\\
	> s^4&2&0&-2\\
	> s^3&8&0\\
	> s^2&0&-2
	> \end{matrix}
	> $$
	> 我们发现$s^2$行第一个数为零，用$\varepsilon$代替
	> $$
	> \begin{matrix}
	> s^5&1&0&-1\\
	> s^4&2&0&-2\\
	> s^3&8&0\\
	> s^2&\varepsilon&-2\\
	> s^1&\frac{16}{\varepsilon}&0\\
	> s^0&-2
	> \end{matrix}
	> $$
	> 第一列元素变号一次，有一个正根，两个纯虚根，系统不稳定。

## 系统的频率模型
### 幅相频率特性
> [!definition] Nyquist图
> ![[Pasted image 20240919102839.png|425]]
> 如上图，以$G(j\omega)=\frac{1}{j\omega T+1}$为例，蓝色曲线描述了其幅频特性$|G(j\omega)|$，绿色曲线描述了其相频特性$\angle G(j\omega)$。而$G(j\omega)$可以看作复平面上的一个向量（图中黄色箭头），随着$\omega$的变化，我们可以作出一条轨迹，此轨迹即为Nyquist曲线，它可以同时描述$G(j\omega)$的幅相特性。

### 对数频率特性
> [!definition] Bode图
> Bode图的横轴标的是$\omega$，但本质上是以$\lg\omega$来呈现的；纵轴为$L(\omega)=20\lg|G(j\omega)|$，单位为分贝。
> 
> ![[Pasted image 20240919144343.png|350]]
> 如上图，以$G(j\omega)=\frac{1}{j\omega T+1}$为例，蓝色曲线描述了其幅频特性$L(\omega)$，绿色曲线描述了其相频特性$\varphi(\omega)$，二者的具体解析式如下：
> $$
> \left\{\begin{aligned}
> L(\omega)&=-20\lg\sqrt{1+\omega^2T^2}\\
> \varphi(\omega)&=-\arctan\omega T
> \end{aligned}\right.
> $$

> [!note] 
> - 上图中的蓝线并不是$L(\omega)$的准确图像，而是与其近似的折线；
> - 上面Bode图与再上面Nyquist图中的同颜色曲线，其实描述了相同的物理量，只不过有的坐标轴是对数坐标轴。

由传递函数绘制Bode图遵循以下步骤：
1. 将传递函数化为尾1标准型；
2. 顺序列出其转折频率，一阶部分$Ts+1$的转折频率为$\frac{1}{T}$，二阶部分$s^2+2\xi\omega_ns+\omega_n^2$的转折频率为$\omega_n$；
3. 找一个基准点，这里取$(\omega,L(\omega))=(1,20\lg K)$；
4. 依据单独$s$的个数，找到初始斜率（$s$在分数线上就$+20$斜率，在分数线下就$-20$斜率），经过基准点作一条以此为斜率的直线；
5. 从左到右画折线，遇到转折频率则根据对应项在分母还是分子上$\pm20$斜率（二阶部分$\pm40$）。

> [!example] 
> 以下面的传递函数为例：
> $$G(s)=\frac{40(s+0.5)}{s(s+0.2)(s^2+s+1)}$$
> 其尾1标准型为
> $$G(s)=\frac{100\left( \frac{s}{0.5}+1 \right)}{s\left( \frac{s}{0.2}+1 \right)(s^2+s+1)}$$
> 其转折频率与对应斜率变化为$0.2\to-20,0.5\to+20,1\to-40$，基准点为$(1,40)$，初始斜率为$-20$。

### 稳定裕度
对于稳定系统来说，其稳定的程度也有所区别，我们用**稳定裕度**来衡量系统稳定的程度。

> [!definition] 稳定裕度
> 在保持系统稳定的前提下，系统中某个量变化的宽裕程度，即为此变量的裕度。
> 
> ![[Pasted image 20240919211404.png|250]]
> - 首先定义截止频率$\omega_{c}$满足$|G(j\omega_{c})|=1$，即Bode图中幅频特性曲线与横轴的交点，再求得负实轴与此交点间的角度，即为**相角裕度**
> 	$$\gamma=\pi+\angle G(j\omega_{c})$$
> - 定义相角交界频率$\omega_{g}$满足$\angle G(j\omega_{g})=-\pi$，再由此求得**幅值裕度**
> 	$$h=\frac{1}{|G(j\omega_{g})|}$$

> [!note] 
> ![[Pasted image 20240921231925.png|325]]
> 实际计算时，若直接解$|G(j\omega_{c})|=1$来得到$\omega_{c}$将会变成去解一个高次多项式，只能通过试根来得出近似解。此时可以*使用Bode图中的近似折线快速得到一个略有偏差的解*。
