---
tags:
  - Knowledge
aliases:
  - Game Theory
---
## 课程信息
- 记录 10%
- 5次作业 50%
- 研究/总结项目 40%
	- 工作 20%
	- 展示 10%
	- 报告 10%
## 战略形式博弈 Strategic Form Game
### 基本概念
**博弈(Game)**的基本要素：
- **玩家(Players/Agents)**
- **策略(Strategy)**：是玩家的行动模式；
- **收益(Utility/Payoff)**：用以表示玩家得到的收益与损失；
- **结果(Outcomes)**：整个系统最终会演变成什么样子。

博弈与其它优化问题的区别：
- 最优化理论(Optimization Theory)：对于决策变量$x\in\mathbb{R}^n$，$$
	\begin{aligned}
		\text{Maximize}&\sum_i u_i(x) \\
		\text{Subject to}\ &x\in X\subset\mathbb{R}^n
	\end{aligned}
	$$
- 而博弈论则是一个多代理的决策问题：系统中有$n$个代理，而每个代理都会以最大化他们自己的效用函数$u_i(x)$为目的，来选择决策变量，即$$\text{Maximize}\ u_i(x_i,x_{-i})$$其中，$x_{-i}=(x_1,...,x_{i-1},x_{i+1},...,x_n)$

> [!example] Braess’ Paradox
> ![[Pasted image 20240220152402.png|400]]
> 共有60个人要从s点到t点。最优解是各分30人走上下两路，此时所有人通勤时间为90min；但此时走x-0-x那条路对于每个人会更省时间，因此人们会选择走这条路，直到所有人的通勤时间变为120min。此时Price of Anarchy (PoA) = $\frac{NE}{OPT}$ = $\frac{2}{1.5}$


- **战略形式博弈(Strategic Form Game)**：也称**标准形式博弈(Normal Form Game)**，有如下特点
	- 有$n$个玩家
	- 其策略集$A$是一个*有限*的*离散*集合，$A_i$则代表玩家$i$可以选择的策略的集合，$a_i$则是玩家$i$选择的一个确定的策略，$a_i\in A_i$
	- 对于玩家$i$，他的效用是$u_i(a_1,a_2,...,a_n)$，可简写为$u_i(a)$
### 纯策略与混合策略
- **纯策略(Pure Strategy)**：在给定的信息下，每个玩家只能选择一种策略，这个策略称为纯策略。
- **混合策略(Mixed Strategy)**：与纯策略相对的，一个玩家选择的策略不是确定的，而是有一定的概率选择某一种策略，那么这种策略称为混合策略。

混合策略下的payoff按下式计算：
$$\sum_{a_1\in A_1}\sum_{a_2\in A_2}...\sum_{a_n\in A_n}u_i(a)P_1(a_1)P_2(a_2)...P_n(a_n)$$
此时，玩家$i$的best response是$BP_{i}(a_{-i})$
- 其中$P_i(a_i)$指$i$玩家采用策略$a_i$的概率，$a_{-i}$指除了玩家$i$之外其它玩家的策略
- $BP_i(a_{-i})$即指对于其它决策为$a_{-i}$时，玩家$i$的最优策略(Best Response Action)的*集合*
- $BP_i(a_{-i})$是一个凸集

> [!note] 对于符号的理解
> 课上给的符号比较混乱，这里说说我自己的理解。
> 
> 一场混合策略博弈中，玩家$i$的策略是一个向量$a_i=[a_{i1},a_{i2},...]^T$，其中$a_{ij}$是玩家$i$采取第$j$种策略的概率，$a_i$的所有可能的取值所组成的策略空间则表示为$A_i$。那么所有玩家的策略便可以组成一个矩阵$a=[a_1,a_2,\cdots]$，其策略空间则表示为$A$。
### 纳什均衡
- **纳什均衡(Nash Equilibrium, NE)**：对于$\forall i$，若$$u_i(a_i^*,a_{-i}^*) \geq u_i(a_i,a_{-i}^*)$$，则$a^*=(a_1^*,a_2^*,...,a_n^*)$是一个NE，即对于所有人来说，$a_i^*$都是给定了其他人策略$a_{-i}^*$的情况的最优策略。其数学表达如下：$$a^*\in BP(a^*)$$其中$a^*$和$BP(a^*)$都是一个$n$维向量，也即表示$\forall i,a_i^*\in BP_i(a_i^*)$。由此可得出，若算子$BP$有一个不动点(Fixed Point)，则这个博弈有一个解是NE。
> [!example] 举例
> 对于小组作业，有以下效用矩阵：
> 
|      | Work          | Lazy    |
| ---- | ------------- | ------- |
| Work | (10, 10)      | (-5, 5) |
| Lazy | (5, -5) | (0, 0) |
> - 对于pure决策：两人都work与两人都lazy都是NE。
> - 对于mixed决策：可以设玩家1 work的概率为$x$，玩家2 work的概率为$y$，则可算出$$x^*=
> 	\left\{\begin{aligned}
> 		1,&y>\frac{1}{2} \\
> 		0,&y<\frac{1}{2} \\
> 		[0,1],&y=\frac{1}{2}
> 	\end{aligned}\right.,\quad y^*=
> 	\left\{\begin{aligned}
> 		1,&x>\frac{1}{2} \\
> 		0,&x<\frac{1}{2} \\
> 		[0,1],&x=\frac{1}{2}
> 	\end{aligned}\right.$$
> 	在图中画出取二者的交集，得到三个NE——$(0,0)(1,1)(\frac{1}{2},\frac{1}{2})$。
### 占优均衡
- **占优策略(Dominant Strategy)**：对于玩家$i$来说，如果$\exists a_i^*$，对于$\forall a_i,a_{-i}$，都有$$u_i(a_i,a_{-i})\leq u_i(a_i^*,a_{-i})$$，则$a_i^*$称为占优策略；也即无论其它玩家选择什么策略，$a_i^*$都是玩家$i$能选择的最优策略。
- **占优均衡(Dominant Strategy Equilibrium, DSE)**：若策略组合$a^*=(a_1^*,a_2^*,\cdots,a_{n}^*)$，对于所有玩家$i$来说，$a_i^*$均为占优策略，则称$a^*$为占优均衡。占优均衡*不一定*存在。
- **被占优策略(Dominanted Strategy)**：对于玩家$i$来说，若$\exists a_i'$，使得对于$\forall a_{-i}$都有$$u_i(a_i',a_{-i})>u_i(a_i,a_{-i})$$，则称那些$a_i$为被占优策略；也即无论其它玩家选择什么策略，被占优策略$a_i$都不是最优策略。
### 相关均衡
- **相关均衡(Correlated Equilibrium, CE)**：对于$\forall a_i,a_i'$，都有$$\sum_{a_{-i}}P(a_{-i}|a_i)u_i(a_i',a_{-i})\leq\sum_{a_{-i}}P(a_{-i}|a_i)u_i(a_i,a_{-i})$$，其中$a_i$是指示玩家$i$选择的策略，$P(a_{-i}|a_i)$则是根据这个指示推算出的其它玩家选择策略$a_{-i}$的概率。因此等式左侧代表玩家$i$不遵从指示，而选择策略$a_i'$所得到的效用；右侧代表遵从指示得到的效用。综上，遵从指示进行选择策略的收益最高的策略。
> [!example] 相关均衡举例
>两个玩家的效用表如下：
>
|     | d   | c   |
| --- | --- | --- |
| d   | 0,0 | 4,1 |
| c   | 1,4 | 3,3 |
>此时有一个上帝给出了信号可能产生的概率如下：
>
|     | d   | c   |
| --- | --- | --- |
| d   | $0$ | $\frac{3}{8}$ |
| c   | $\frac{3}{8}$ | $\frac{1}{4}$ |
>玩家只能看到这个信号概率的表格和给自己的指示，例如玩家一得到的指示是$c$，说明此时玩家二选择$c$的概率是$\frac{3}{5}$，选$d$的概率是$\frac{2}{5}$，所以听从指示选$c$的期望效用是$\frac{9}{5}$，不听从指示选$d$的期望效用则为$\frac{8}{5}$，听从更好；反之，若指示为$d$，同样是听从更好。此时就是一个相关均衡。

由以上例子可见，若有较权威的第三方给出一个合理的指示，就可以提高整个系统的收益情况。
> [!note] 相关均衡与纳什均衡的关系
> *纳什均衡是相关均衡的一个特殊情况。*二者的区别在于，纳什均衡中每个玩家都是独立去选择策略的，而相关均衡中的指示会对玩家策略的独立性产生影响。可以通过设计指示的概率，来使相关均衡退化为纳什均衡。![[Pasted image 20240320084030.png|250]]
> 纯策略纳什均衡、混合策略纳什均衡与相关均衡关系如上图所示。

我们可以将相关均衡写作一个线性规划的形式：
$$
\begin{aligned}
\max\sum_i\sum_{a_{-i}}P(a_{-i}|a_i)&u_i(a_i,a_{-i})\\
\sum_{a\in A}P(a)=1\\
P(a)\geq0
\end{aligned}
$$
### 零和博弈
相关均衡可以写作线性规划的形式求出结果，但MNE的求解则更加复杂，此处考虑一个特殊情况，即零和博弈。
- **零和博弈(Zero-sum Game)**：任意一种策略下，所有玩家的收益和都为0。

因此，设$x,y$分别为玩家A和玩家B策略的概率分布，矩阵$A$则为其收益矩阵，则此博弈中的纳什均衡点$x^*,y^*$满足以下条件：
$$
\left\{\begin{aligned}
x^{*T}Ay^*&\geq x^TAy^*&,\forall x\\
x^{*T}Ay^*&\leq x^{*T}Ay&,\forall y
\end{aligned}\right.
$$
此处的$(x^*,y^*)$也称为**鞍点(Saddle Point)**。
- **MiniMax定理**：$$\min_{y}\max_{x}x^TAy=\max_{x}\min_{y}x^TAy$$
> [!note] Remark
> 在零和博弈中，若$(x^*,y^*),(\tilde{x},\tilde{y})$都是NE，则$(x^*,\tilde{y}),(\tilde{x},y^*)$也是NE。

以$\min_{y}\max_{x}x^TAy$为例，我们需要将其转化为一个线性规划问题方便求解。易知$\max_{x}x^TAy$的结果其实就是列向量$Ay$中最大的那个元素，设这个元素为$v$，便可表示为一个约束条件$Ay\leq v\mathbb{1}$；再将$v$代入回原问题，则变为
$$
\begin{aligned}
\min_y&\ v\\
s.t.\quad Ay&\leq v\mathbb{1}\\
y^T\mathbb{1}&=1\\
y&\geq0
\end{aligned}
$$
### 非零和博弈
#### Brouwer不动点定理证明NE存在
- **Brouwer不动点定理(Brouwer's Fixed Point Theorem)**：一个*封闭(Closed)有界(Bounded)凸集*$C\subseteq\mathbb{R}^n$对其自身的映射$f:C\to C$若为一个*连续*函数，则$\exists x\in C,x=f(x)$。

设$a=(a_i,a_{-i})$是原策略，$a_i'$为玩家$i$根据原策略中其他玩家的策略$a_{-i}$所制定的最优策略，则定义$$f(a)=a'$$
此时可知此博弈中的策略空间为有界闭凸集，$f$为连续映射，那么根据Brouwer不动点定理，存在一个不动点$a^*$使得$f(a^*)=a^*$，此策略即为NE，NE的存在性得证。
#### 角谷静夫不动点定理证明NE存在
对于NE的存在性证明，我们还有另一个形式的表示，对于此形式的证明需要用到另一个不动点定理。
- **角谷静夫不动点定理(Kakutani Fixed Point Theorem)**：若集合$C\subseteq\mathbb{R}$为有界闭凸集，$f:C\to C$是一个具有[[离散数学#^x840vj|闭图]]的映射，且对于$\forall x\in C$，$f(x)$是一个非空凸集，则$f$存在一个不动点。

对于函数$BP$来说：
1. 一个有界闭区间内的连续函数一定有一个极值点，因此$BP(a)$对于$\forall a$都是非空的；
2. 对于$\forall a$，$BP(a)$都是凸集；
3. $BP$具有闭图。

因此得证$BP$存在一个不动点。
### 无限纯策略博弈
对于无限纯策略博弈，玩家$i$的策略$a_i$就不再是一个向量了，而一般是一个连续变化的数，即$a_i\in\mathbb{R}$，同时整个策略$a$则可以表示为一个向量，其策略空间表示为$\Omega$。由于一般会在策略上加上一些限制，所以此处的$\Omega$不一定是凸集。
- 定理：若$\Omega$是一个有界闭凸集，且对于$\forall a_{-i}$，$u_i(a_i,a_{-i})$是关于$a_i$的凹函数，则此博弈有PNE。

构造一个函数
$$L(b,a)=\sum_{i=1}^{n}u_i(b_i,a_{-i})$$
其中$a,b\in\Omega$。在前一次策略$a$的基础上，任意一个玩家$i$都在参照着上一次其它玩家的策略$a_{-i}$来确定自己此次的策略$b_i$，则$L(b,a)$则是每个玩家根据前一次的策略$a$调整到策略$b$后，认为自己应得的收益之和。所以
$$\max_{b\in\Omega}L(b,a)$$
的含义即为，在前一次策略为$a$的情况下，每个玩家都挑选对自己利益最大的策略时，玩家所期望的收益之和。

因此，可构造函数
$$g(a)=\mathop{\arg\!\max}\limits_{b\in\Omega}\ L(b,a)$$
若欲证明其有PNE，只需证明$\exists a$使得$a\in g(a)$，证明如下：
1. $\forall a,g(a)\neq\varnothing$；
2. 因为$u$为凹函数，可证$L$对于$b$也为凹函数，进而证明对于$\forall a$，$g(a)$都是凸集；
3. 易证$g$具有闭图（我懒得补了）。

综上，对于策略空间$\Omega$为有界闭凸集的无限纯策略博弈，其有PNE。






补到3月26