---
tags:
  - Knowledge
aliases:
  - Ridge Regression
---
## 岭回归
> [!definition] 岭回归 (Ridge Regression)
> 形式上就是线性回归加上一个正则化项$\lambda||\beta||^2$。令$X$为$n$行$p$列的矩阵，表示$n$个$p$维向量的集合，则岭回归的损失函数为
> $$l(\beta)=||Y-X\beta||^2+\lambda||\beta||^2$$

由于其损失函数为凸函数，因此其最小化问题$\min_{\beta}l(\beta)$为一个凸优化，解出其[[凸优化#KKT条件|KKT条件]]中的稳定性条件即可得到其最优解，即解
$$
\begin{aligned}
&\frac{\partial l}{\partial \beta}=-2X^T(Y-X\beta)+2\lambda\beta=0\\
\implies&\hat{\beta}_{\lambda}=(X^TX+\lambda I)^{-1}X^TY
\end{aligned}
$$
![[Pasted image 20240419101910.png|475]]
由图中可以看到，正则化项$\lambda||\beta||^2$惩罚了那些有权重上有绝对优势的特征，使得权重的分布更加均匀，不让鸡蛋都放在一个篮子里，增强了模型的鲁棒性。
## 岭回归的形式来源
假设
$$
\left\{\begin{aligned}
\beta&\sim N(0,\tau^2I_{p})\\
\varepsilon&\sim N(0,\sigma^2I_n)
\end{aligned}\right.
$$
则在所有样本下，$\beta$的最大似然估计为
$$P(\beta|X,Y)=\frac{P(\beta|X)P(Y|X\beta)}{P(Y|X)}$$
我们分别看这三部分：
- $P(Y|X)$是固定的；
- 由于$Y=X\beta+\varepsilon$，因此$P(Y|X\beta)\sim P(\varepsilon)$；
- 当$Y$不确定，只有$X$没法控制住$\beta$，所以$P(\beta|X)\sim P(\beta)$。

因此可以认为
$$
\begin{aligned}
P(\beta|X,Y)&\varpropto P(\beta)P(Y|X\beta)\\
&\varpropto\exp\left( -\frac{1}{2\tau^2}|\beta|^2 \right)\exp\left( -\frac{1}{2\sigma^2}|Y-X\beta|^2 \right)\\
&=\exp\left( -\frac{1}{2}\left[ \frac{1}{\sigma^2}|Y-X\beta|^2+\frac{1}{\tau^2}|\beta|^2 \right] \right)
\end{aligned}
$$
因此
$$\mathop{\arg\!\max}\limits_{\beta}\ P(\beta|Y,X)=\mathop{\arg\!\min}\limits_{\beta}\ |Y-X\beta|^2+\frac{\sigma^2}{\tau^2}|\beta|^2$$
可以看到等式右侧如果把$\frac{\sigma^2}{\tau^2}$换成$\lambda$就是岭回归，即*岭回归的本质是对于$\beta$的最大似然估计*。$$$$
## 核回归
> [!definition] 核回归 (Kernel Regression)
> 在原岭回归的基础上使用[[SVM#核方法|核方法]]，将原特征$X_{n\times p}$变为一个核$K_{n\times n}$，则原岭回归变为
> $$
> \begin{aligned}
> &\min_{c}\sum_{i=1}^{n}\left\lVert y_i-\sum_{j=1}^{n}c_jK_{ij}\right\rVert^2+\lambda\sum_{i,j}c_ic_jK_{ij}\\
> =&\min_{c}\left\lVert Y-Kc\right\rVert^2+\lambda c^TKc
> \end{aligned}
> $$

同样求解其稳定性条件
$$\frac{\partial l}{\partial c}=0\implies\hat{c}_{\lambda}=(K+\lambda I)^{-1}Y$$
此处正则化项$\lambda c^TKc$同样起到均匀权重分布的作用。

从岭回归的视角观察核回归，可以发现核回归的损失函数为
$$\left\lVert Y-\phi(X)\beta\right\rVert^2+\lambda\left\lVert\beta\right\rVert^2$$
其中$\beta=\sum_ic_i\phi(x_i)$，将其代入后可以看到，此函数就是核回归的损失函数。因此，核回归的本质也是一个岭回归。
## 样条回归
> [!definition] 样条回归 (Spline Regression)
> ![[Pasted image 20240419113527.png|250]]
> 通过分段线性模型来进行拟合。其损失函数如下
> $$\sum_{i=1}^{n}\left\lVert y_i-\alpha_0-\sum_{j=1}^{p}\alpha_j\max(0,x_i-k_j)\right\rVert^2+\lambda\sum_{j=1}^{p}\alpha_j^2$$

将其改写为矩阵的表达形式
$$l(\alpha)=\left\lVert Y-Z\alpha\right\rVert^2+\lambda\left\lVert D\alpha\right\rVert^2$$
其中
$$
\left\{\begin{aligned}
Z&=
\begin{bmatrix}
1&\max(0,x_1-k_1)&\cdots&\max(0,x_1-k_p)\\
1&\max(0,x_2-k_1)&\cdots&\max(0,x_2-k_p)\\
\vdots&\vdots&\ddots&\vdots\\
1&\max(0,x_n-k_1)&\cdots&\max(0,x_n-k_p)
\end{bmatrix}\\
\alpha&=[\alpha_0,\alpha_1,...,\alpha_p]^T\\
D&=\text{diag}(0,1,...,1)
\end{aligned}\right.
$$
与岭回归和核回归同理可得
$$\hat{\alpha}_{\lambda}=(Z^TZ\lambda D)^{-1}Z^TY$$
> [!note] 
> 神经网络的本质也是一个样条回归。为神经网络引入非线性特征的是ReLU函数，其本质就是一个$\max(0,x+1)$，因此神经网络所拟合出的模型其实是由一个个小的线性部分拼接而成的。

