---
tags:
  - Knowledge
aliases:
  - Database System Technology
---
# 课程信息
1. 期末考试 60%
2. 编程大作业 20%
3. 最新进展报告大作业 10%
4. 作业 + 出勤 10%
# 正文
## 概论
### 基本概念
![[Pasted image 20240219145139.png|375]]
- 数据：存储的基本对象；
- 数据库：长期储存在计算机内、有组织、可共享的大量数据集合；
- **数据库管理系统 (Database Management System, DBMS)**：是位于用户与操作系统之间的一层数据管理软件；
- **数据库管理员(Database Administrator, DBA)**：是从事管理和维护数据库管理系统的相关工作人员；
- **数据库系统 (Database System, DBS)**：由*数据库*、*数据库管理系统*、*应用系统*和*数据库管理员*构成。
### 数据库系统特点
1. 数据的结构化
	- 数据的结构是用[[#数据模型]]描述的，无需程序去定义与解释
	- 如下图，数据是可以变长的，其最小存取单位是数据项
		![[Pasted image 20240220215049.png]]
1. 数据的独立性
	- 物理独立性：数据的物理存储改变时，应用程序不需要改变
	- 逻辑独立性：数据的逻辑结构改变时，应用程序也不需要改变
1. 数据的高共享性
	- 节省了存储空间，**降低**了数据的**冗余度**
	- **避免**了同一数据不同拷贝的**不一致性**与**不相容性**
	- 数据库系统弹性大，**易扩充**
1. 数据由DBMS统一管理
	- 安全性(Security)保护：防止泄密与破坏
	- 完整性(Integrity)检查：保持数据的正确性、有效性、相容性
### 数据模型
#### 基本定义
> [!definition] 数据模型
> 数据模型是对现实世界中的数据和信息的抽象、表示与处理。

如下图，数据建模过程分为两步抽象。先把客观事物抽象成概念模型，再根据概念模型做出逻辑模型。
![[Pasted image 20240220220702.png]]

数据模型的三个组成要素如下：
1. **数据结构**：描述数据库组成对象与对象之间的联系，是系统的静态特性
2. **数据操作**：对数据库中对象的实例（值）允许执行的操作规则，是系统的动态特性
3. 数据的**完整性约束条件**：是一组完整性规则的集合，其中完整性规则指对数据及其联系的制约和储存规则，用来保证数据的正确、有效、相容（如对齐数据单位）
#### 概念模型
> [!definition] 概念模型
> 概念模型是现实世界到机器世界的一个中间层次，可以被用户读懂。

信息世界的基本概念：
1. 实体：客观存在并可相互区别的事物
2. 属性：实体具有的某一特性
3. 码：唯一标识实体的属性集
4. 域：属性的取值范围称为该属性的域
5. 实体型：实体的类别
6. 实体集：同型实体的集合
7. 联系：实体内部或实体之间的联系

> [!definition] E-R图
> 使用矩形表示实体，椭圆形表示属性，菱形表示联系，在无向边上标出联系的类型，如图
> ![[Pasted image 20240219153301.png|215]]

> [!caution] 注*
> - 两个以上实体若想由一个联系连接，这些实体必须两两之间有关系
> - 对于码属性相同的实体，可以由一个实体集表示，然后添加一个属性来表示区分，如教师、教授、副教授之间可以用职称的属性进行区分
> - 除了码属性不能为空，其它属性都可以是空值，如学生的学号不能为空，但学生的专业一栏，在分专业之前就可以是空的

#### 具体模型
##### 关系模型
1. 数据结构：表
2. 基本概念：
	- 关系(Relation)：一个关系通常对应一张表
	- 元组(Tuple)：表中一行即为一个元组
	- 属性(Attribute)：表中一列即为一个属性
	- 主码(Key)：表中的某一**属性组**（不一定是单一属性），可以唯一确定一个元组
	- 域(Domain)：属性的取值范围
	- 分量：某个属性的具体取值，每个分量必须是**不可分**的数据项，即不允许一个分量对应多个数据，查不出来
1. 优缺点：
	- 优点：
		1. 建立在严格的**数学概念**基础上
		2. 数据结构**简单清晰**
##### 层次模型
1. 定义：是一棵树
2. 特点：
3. 优点：
4. 缺点：
##### 网状模型
1. 定义：是一个有向图
2. 完整性约束：了解即可
3. 优缺点：
	- 优点：存取效率高
	- 缺点：结构比较复杂，不利于用户使用
### 数据库系统模式
#### 三级模式 二级映象
![[Pasted image 20240222112906.png]]
- 三级模式
	- **内模式(Internal Schema)**：数据存储的模式，一个数据库只会有一个内模式。
	- **模式(Schema)**：选用什么样的逻辑模型，是整个系统的*核心*，与数据的存储无关，与应用的开发也无关，设计数据库时一般先确定模式。
	- **外模式(External Schema)**：确定用户使用哪一部分数据，通常是模式的子集，对于一个数据库可以有多个外模式。
- 二级映象
	- 外模式/模式映象：每个外模式都对应一个映象，保证数据的*逻辑独立性*。
	- 模式/内模式映象：保证了数据的*物理独立性*。
## 关系模型和关系运算理论
- [[关系模型和关系运算理论#关系数据结构|关系]]
- [[关系模型和关系运算理论#关系的完整性|关系的完整性]]
- [[关系模型和关系运算理论#关系代数|关系代数]]
## 关系规范化基础
- [[关系规范化基础#数据依赖|数据依赖]]
- [[关系规范化基础#关系规范化|关系规范化]]
- [[关系规范化基础#数据依赖的公理系统|数据依赖的公理系统]]
## SQL
- [[SQL#数据定义|数据定义]]
- [[SQL#数据查询|数据查询]]
- [[SQL#数据更新|数据更新]]
- [[SQL#视图|视图]]
## 数据库设计
一个数据库的设计一般要经历如下步骤：
![[Pasted image 20240328154352.png|650]]
- [[数据库设计#需求分析|需求分析]]
- [[数据库设计#概念结构设计|概念结构设计]]
- [[数据库设计#逻辑结构设计|逻辑结构设计]]
- [[数据库设计#物理结构设计|物理结构设计]]
## 数据库完整性
> [!note] 数据库完整性与数据库安全性的区别
> - 数据库完整性是防止不合语义、不正确的数据进入数据库；
> - 数据库安全性则是防止非法用户和非法操作来破坏数据库。

> [!example] 
> ![[Pasted image 20240616213935.png]] #Missing 
> ```sql
> CREATE TRIGGER SC_T
> AFTER UPDATE OF Grade ON SC
> REFERENCING
> 	OLDROW AS OldTuple
> 	NEWROW AS NewTuple
> FOR EACH ROW
> WHEN (NewTuple.Grade >= 1.1 * OldTuple.Grade)
> BEGIN
> 	INSERT INTO SC_U (Sno, Cno, OldGrade, NewGrade)
> 	VALUES(OldTuple.Sno, OldTuple.Cno, OldTuple.Grade, NewTuple.Grade)
> END;
> ```

> [!example] 
> ![[Pasted image 20240616215338.png]] #Missing 
> ```sql
> CREATE TRIGGER Student_Count
> AFTER INSERT ON Student
> REFERENCING
> 	NEWTABLE AS Delta
> FOR EACH STATEMENT
> BEGIN
> 	INSERT INTO StudentInsertLog (Numbers)
> 	SELECT COUNT(*) FROM Delta
> END;
> ```

> [!example] 
> ![[Pasted image 20240616220016.png]] #Missing 
> ```sql
> CREATE TRIGGER CheckSalary
> BEFORE INSERT OR UPDATE ON Teacher
> REFERENCING
> 	NEWROW AS NewTuple
> FOR EACH ROW
> BEGIN
> 	IF (NewTuple.Job = '教授' AND NewTuple.Sal < 4000)
> 		THEN NewTuple.Sal = 4000
> 	ENDIF;
> END;
> ```
## 数据库恢复
- [[数据库恢复#事务|事务]]
- [[数据库恢复#恢复的实现技术|恢复的实现技术]]
- [[数据库恢复#故障类别与其恢复策略|故障类别与其恢复策略]]
- [[数据库恢复#具有检查点的恢复技术|具有检查点的恢复技术]]
## 并发控制
### 概述
并发操作可能带来数据库的不一致性。
### 锁
> [!definition] 排他锁
> 又称为**写锁**、**X锁**，若事务$T$对数据对象$A$加上X锁，则只允许$T$读取与修改$A$

#### 两段锁
![[Pasted image 20240527143856.png|500]]
b中不遵守两段锁协议也能够串行。